<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:i18n="http://xml.zope.org/namespaces/i18n"
      metal:use-macro="context/main_template/macros/master"
      i18n:domain="uu.formlibrary">
<head>
  <metal:block fill-slot="javascript_head_slot">
  <meta name="form-type" content="" tal:attributes="content context/portal_type" />
  <script type="text/javascript">
  //<![CDATA[
  jq = jQuery;
  jq(document).ready(function(){
    var formtype = jq('meta[name="form-type"]').attr('content');
    if (formtype == 'uu.formlibrary.definition') {
        //change label, we don't save
        jq('input.submit-widget#form-buttons-save').val('Test form input');
    }
  });
  //]]>
  </script>
  </metal:block>
  <metal:block fill-slot="style_slot">
<style>
  .configuration-summary { border:1px solid #ccc; background-color:#eee; padding-left:3em; }
  .configuration-summary h5 { padding-left:1em; }  
  #content fieldset { border-top:none !Important; background-color:#e9edfa !Important; border-bottom:1px solid #bbb; padding 0 1em 0 0; }
  #content fieldset legend {width: 100%; display: block; background-color:#ddd; color:#444; font-size:110% !Important; font-weight:bold; line-height:120%; margin-left:-1em; }
  #content #fieldset-default legend { display:none; } /* hide the heading for default fieldset */
  table.datagridwidget-table-view input.smartdate-widget { width:8em !important; }
  table.datagridwidget-table-view input { margin-bottom:0.4em; width:95% !Important; }
  table.datagridwidget-table-view div.smartdate { width: 10em; display:block; padding-top:0.6em; }
</style>
<style tal:condition="python:view.definition.form_css and view.definition.form_css.strip()"
       tal:content="structure view/definition/form_css">
</style>  
  </metal:block>
</head>
<body>
  <div metal:fill-slot="main">
  <h1 tal:condition="python:context.portal_type=='uu.formlibrary.definition'" tal:content="structure string:${context/Title} <em>(Form preview)</em>">TITLE</h1>
  <h2 tal:condition="python: not context.portal_type=='uu.formlibrary.definition'" tal:content="context/Title">TITLE</h2>
  <div tal:content="context/Description">Description</div>
  <div class="configuration-summary">
    <tal:block define="fieldgroups python:[o for o in context.objectValues() if o.portal_type=='uu.formlibrary.fieldgroup']">
    <div tal:condition="fieldgroups">
     <h5>Contained field groups</h5>
     <ul>
       <li tal:repeat="group fieldgroups">
        <a href="" tal:attributes="href group/getId">
          <img src="" 
             tal:condition="python:group.group_usage==u'grid'"
             tal:attributes="src string:${context/@@plone_portal_state/navigation_root_url}/++resource++uu.formlibrary.icons/multiform.png" />
          <img src="" 
             tal:condition="python:group.group_usage==u'group'"
             tal:attributes="src string:${context/@@plone_portal_state/navigation_root_url}/form_icon.png" />
          <span tal:content="group/Title">FIELD GROUP</span>
        </a>
        <em tal:condition="python:group.group_usage==u'grid'">(grid)</em>
       </li>
     </ul>     
    </div>
    </tal:block>
  </div>
  <hr />
    <form tal:replace="structure view/render_form">DATA FORM HERE</form>
  </div>
</body>
</html>
